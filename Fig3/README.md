Source codes for Fig3
