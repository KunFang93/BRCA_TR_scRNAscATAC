Source codes for Fig.6
